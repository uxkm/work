!function(window,factory){"function"==typeof define&&define.amd?define(["flickity/js/index","fizzy-ui-utils/utils"],factory):"object"==typeof module&&module.exports?module.exports=factory(require("flickity"),require("fizzy-ui-utils")):factory(window.Flickity,window.fizzyUIUtils)}(this,(function factory(Flickity,utils){var Slide=Flickity.Slide,slideUpdateTarget=Slide.prototype.updateTarget;Slide.prototype.updateTarget=function(){if(slideUpdateTarget.apply(this,arguments),this.parent.options.fade){var slideTargetX=this.target-this.x,firstCellX=this.cells[0].x;this.cells.forEach((function(cell){var targetX=cell.x-firstCellX-slideTargetX;cell.renderPosition(targetX)}))}},Slide.prototype.setOpacity=function(alpha){this.cells.forEach((function(cell){cell.element.style.opacity=alpha}))};var proto=Flickity.prototype;Flickity.createMethods.push("_createFade"),proto._createFade=function(){this.fadeIndex=this.selectedIndex,this.prevSelectedIndex=this.selectedIndex,this.on("select",this.onSelectFade),this.on("dragEnd",this.onDragEndFade),this.on("settle",this.onSettleFade),this.on("activate",this.onActivateFade),this.on("deactivate",this.onDeactivateFade)};var updateSlides=proto.updateSlides;proto.updateSlides=function(){updateSlides.apply(this,arguments),this.options.fade&&this.slides.forEach((function(slide,i){var alpha=i==this.selectedIndex?1:0;slide.setOpacity(alpha)}),this)},proto.onSelectFade=function(){this.fadeIndex=Math.min(this.prevSelectedIndex,this.slides.length-1),this.prevSelectedIndex=this.selectedIndex},proto.onSettleFade=function(){var fadedSlide;(delete this.didDragEnd,this.options.fade)&&(this.selectedSlide.setOpacity(1),this.slides[this.fadeIndex]&&this.fadeIndex!=this.selectedIndex&&this.slides[this.fadeIndex].setOpacity(0))},proto.onDragEndFade=function(){this.didDragEnd=!0},proto.onActivateFade=function(){this.options.fade&&this.element.classList.add("is-fade")},proto.onDeactivateFade=function(){this.options.fade&&(this.element.classList.remove("is-fade"),this.slides.forEach((function(slide){slide.setOpacity("")})))};var positionSlider=proto.positionSlider;proto.positionSlider=function(){this.options.fade?(this.fadeSlides(),this.dispatchScrollEvent()):positionSlider.apply(this,arguments)};var positionSliderAtSelected=proto.positionSliderAtSelected;proto.positionSliderAtSelected=function(){this.options.fade&&this.setTranslateX(0),positionSliderAtSelected.apply(this,arguments)},proto.fadeSlides=function(){if(!(this.slides.length<2)){var indexes=this.getFadeIndexes(),fadeSlideA=this.slides[indexes.a],fadeSlideB=this.slides[indexes.b],distance=this.wrapDifference(fadeSlideA.target,fadeSlideB.target),progress=this.wrapDifference(fadeSlideA.target,-this.x);progress/=distance,fadeSlideA.setOpacity(1-progress),fadeSlideB.setOpacity(progress);var fadeHideIndex=indexes.a,isNewHideIndex;this.isDragging&&(fadeHideIndex=progress>.5?indexes.a:indexes.b),null!=this.fadeHideIndex&&this.fadeHideIndex!=fadeHideIndex&&this.fadeHideIndex!=indexes.a&&this.fadeHideIndex!=indexes.b&&this.slides[this.fadeHideIndex].setOpacity(0),this.fadeHideIndex=fadeHideIndex}},proto.getFadeIndexes=function(){return this.isDragging||this.didDragEnd?this.options.wrapAround?this.getFadeDragWrapIndexes():this.getFadeDragLimitIndexes():{a:this.fadeIndex,b:this.selectedIndex}},proto.getFadeDragWrapIndexes=function(){var distances=this.slides.map((function(slide,i){return this.getSlideDistance(-this.x,i)}),this),absDistances=distances.map((function(distance){return Math.abs(distance)})),minDistance=Math.min.apply(Math,absDistances),closestIndex=absDistances.indexOf(minDistance),distance=distances[closestIndex],len=this.slides.length,delta=distance>=0?1:-1;return{a:closestIndex,b:utils.modulo(closestIndex+delta,len)}},proto.getFadeDragLimitIndexes=function(){for(var dragIndex=0,i=0;i<this.slides.length-1;i++){var slide=this.slides[i];if(-this.x<slide.target)break;dragIndex=i}return{a:dragIndex,b:dragIndex+1}},proto.wrapDifference=function(a,b){var diff=b-a;if(!this.options.wrapAround)return diff;var diffPlus=diff+this.slideableWidth,diffMinus=diff-this.slideableWidth;return Math.abs(diffPlus)<Math.abs(diff)&&(diff=diffPlus),Math.abs(diffMinus)<Math.abs(diff)&&(diff=diffMinus),diff};var _getWrapShiftCells=proto._getWrapShiftCells;proto._getWrapShiftCells=function(){this.options.fade||_getWrapShiftCells.apply(this,arguments)};var shiftWrapCells=proto.shiftWrapCells;return proto.shiftWrapCells=function(){this.options.fade||shiftWrapCells.apply(this,arguments)},Flickity}));